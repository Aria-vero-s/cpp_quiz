<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Quiz — Vivant ou Mort (durée de vie en C++)</title>

    <link rel="stylesheet" href="styles.css">

    <!-- Prism for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- Local small layout tweaks just for the start screen (no need to edit styles.css) -->
    <style>
        /* start-panel layout overrides (small and safe) */
        .start-block {
            width: 100%;
            max-width: 980px;
            display: grid;
            grid-template-columns: 140px 1fr;
            gap: 18px;
            align-items: center;
            padding: 14px;
            border-radius: 12px;
        }

        .start-block .logo-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px;
            border-radius: 12px;
            background: linear-gradient(180deg, rgba(139, 211, 199, 0.06), rgba(139, 211, 199, 0.03));
        }

        .start-block .logo-panel img {
            width: 110px;
            height: 110px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(3, 6, 12, 0.6);
        }

        .start-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .start-controls .top {
            display: flex;
            justify-content: space-between;
            gap: 12px;
            align-items: start;
        }

        .start-controls h2 {
            margin: 0;
            font-size: 18px;
        }

        .start-row {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        #numQ,
        #timeQ {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.06);
            color: inherit;
            padding: 6px 8px;
            border-radius: 8px;
            font-size: 14px;
        }

        /* responsive: stack columns on narrow screens */
        @media (max-width: 720px) {
            .start-block {
                grid-template-columns: 1fr;
            }

            .start-block .logo-panel {
                flex-direction: row;
                gap: 12px;
            }

            .start-controls .top {
                flex-direction: column;
                align-items: stretch;
            }

            .start-controls .actions {
                display: flex;
                gap: 8px;
                flex-wrap: wrap;
            }
        }
    </style>
</head>

<body>
    <div class="app card" role="application" aria-labelledby="title">
        <header>
            <div>
                <h1 id="title">Quiz — Vivant ou Mort (durée de vie en C++)</h1>
                <p class="lead">Teste ta compréhension des durées de vie : références, temporaires, static et pointeurs.
                </p>
            </div>
        </header>

        <main id="main">
            <!-- start screen -->
            <section id="start" class="center">
                <div class="start-block">
                    <div class="logo-panel">
                        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='110' height='110'><rect rx='20' width='110' height='110' fill='%2320372b'/><text x='50%' y='52%' dominant-baseline='middle' text-anchor='middle' font-size='42' font-family='Arial' fill='%238bd3c7'>C++</text></svg>"
                            alt="logo" />
                        <div style="height:10px;"></div>
                        <div class="small" style="color:var(--muted); text-align:center; max-width:120px;">Durée de vie
                            &amp;
                            références</div>
                    </div>

                    <div class="start-controls" aria-hidden="false">
                        <div class="top">
                            <div>
                                <h2 style="font-weight:700">Prêt·e pour le quiz ?</h2>
                                <p class="small" style="margin:6px 0 0 0;">Réponds vite : Vivant ou Mort — apprends avec
                                    des
                                    explications.</p>
                            </div>

                            <div style="text-align:right">
                                <div class="pill" style="font-size:12px">Questions: <strong id="qcount">0</strong></div>
                                <div style="height:6px"></div>
                                <div class="pill" style="font-size:12px">Temps / Q: <span id="qtime">12</span>s</div>
                            </div>
                        </div>

                        <div class="start-row" style="margin-top:6px;">
                            <button id="startBtn" class="btn" style="padding:10px 14px;">DÉMARRER</button>
                            <button id="showRules" class="btn secondary" style="padding:10px 14px">Voir les règles /
                                Exemples</button>
                        </div>

                        <div class="small" style="color:var(--muted);margin-top:8px">Note : Les résultats sont
                            téléchargeables à la fin.</div>
                    </div>
                </div>
            </section>

            <!-- countdown -->
            <section id="countdown" class="center" style="display:none;flex-direction:column">
                <div class="countdown" id="countText">3</div>
                <p class="small">Prépare-toi... le quiz commence bientôt</p>
            </section>

            <!-- quiz area -->
            <section id="quiz" style="display:none">
                <div class="question-area">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <div>
                            <div class="pill" id="progress">Question <span id="cur">1</span>/<span id="total">1</span>
                            </div>
                        </div>
                        <div class="meta">
                            <div class="pill">Temps restant: <strong id="timeLeft">12s</strong></div>
                            <div class="pill" id="score">Score: 0</div>
                        </div>
                    </div>

                    <div class="question" id="questionText">Question</div>

                    <div class="choices">
                        <button class="choice" data-answer="alive" id="btnAlive">Vivant</button>
                        <button class="choice" data-answer="dead" id="btnDead">Mort</button>
                    </div>

                    <div class="timer" aria-hidden="true"><i id="bar" style="width:100%"></i></div>

                    <div id="feedback" style="display:none">
                        <div class="explain" id="explainText"></div>
                    </div>

                </div>

                <footer class="controls">
                    <div class="small">Réponse rapide: clique Vivant ou Mort. Tu peux aussi laisser le temps s'écouler.
                    </div>
                    <div>
                        <button id="nextBtn" class="btn secondary" style="display:none">Suivant</button>
                    </div>
                </footer>
            </section>

            <!-- results -->
            <section id="results" style="display:none">
                <h2>Résultats</h2>
                <p class="small" id="summary"></p>
                <div class="results" id="resultsList"></div>
                <div style="height:8px"></div>
                <div style="display:flex;gap:8px">
                    <button id="retry" class="btn">Rejouer</button>
                    <button id="download" class="btn secondary">Télécharger mes résultats</button>
                </div>
            </section>

            <!-- rules modal with nice code blocks -->
            <section id="rules" style="display:none">
                <h3>Règles & exemples</h3>
                <div class="small">Tu dois décider si la variable référencée est <strong>vivante</strong> (encore
                    existante) ou
                    <strong>morte</strong> (détruite). Les cas fréquents :
                </div>
                <ul class="small">
                    <li>Variables locales : <em>mortes</em> à la fin du bloc.</li>
                    <li>Variables globales & static : <em>vivantes</em> jusqu'à la fin du programme.</li>
                    <li>Une référence non-const (<code>T&</code>) ne peut pas se lier à un tempora (rvalue) — le
                        compilateur empêche
                        souvent l'erreur.</li>
                    <li>Attention aux pointeurs et références stockés : vérifier la durée de vie de l'objet pointé.</li>
                </ul>

                <h4>Exemple sûr (Weapon.hpp)</h4>
                <pre class="language-cpp">
                    <code>
                    // Weapon.hpp
                    #ifndef WEAPON_H
                    #define WEAPON_H

                    #include <string>

                    class Weapon {
                    private:
                        std::string type;
                    public:
                        Weapon(const std::string& t);
                        void setType(const std::string& t);
                        const std::string& getType() const;
                    };

                    #endif
                    </code>
                </pre>

                <h4>Exemple dangereux (dangling reference)</h4>
                <pre class="language-cpp">
                    <code>
                        // NE PAS FAIRE
                        std::string& makeRef() {
                            std::string temp = "Hello"; // local
                            return temp;                  // retourne référence vers local détruit
                        }

                        int main() {
                            std::string& r = makeRef();   // UB: r référence un objet mort
                        }
                    </code>
                </pre>
                <div style="height:8px"></div>
                <button id="closeRules" class="btn">Fermer</button>
            </section>
        </main>
    </div>
    <script src="script.js"></script>
</body>
</html>